<p-dialog
  header="Ajouter une politique"
  [(visible)]="isVisibleDialog"
  (onHide)="closeDialog()"
  [style]="{ width: '25rem' }"
>
  <form
    [formGroup]="policyForm"
    (ngSubmit)="createPolicie()"
    class="flex flex-column gap-3"
  >
    <input
      pInputText
      placeholder="Nom de la politique"
      formControlName="name"
      style="width: 100%"
    />
    @if (
      policyForm.controls.name.invalid &&
      (policyForm.controls.name.touched || policyForm.controls.name.dirty)
    ) {
      @if (policyForm.controls.name.hasError("required")) {
        <small class="text-red-500">Le nom est obligatoire</small>
      }

      @if (policyForm.controls.name.hasError("minlength")) {
        <small class="text-red-500">Minimum 3 lettres</small>
      }
    }
    @if (firewall$ | async; as firewalls) {
      <p-select
        [options]="firewalls.items"
        optionLabel="name"
        optionValue="id"
        [filter]="true"
        filterBy="name"
        [showClear]="true"
        placeholder="Séléctionnez un firewall"
        [appendTo]="'body'"
        style="width: 100%"
        formControlName="firewall_id"
      >
        <ng-template #selectedItem let-selectedOption>
          <div class="flex items-center gap-2">
            <div>{{ selectedOption.name }}</div>
          </div>
        </ng-template>
        
      </p-select>
    }

    <div class="flex justify-content-end gap-2 mt-2">
      <p-button label="Annuler" severity="secondary" (click)="closeDialog()" />
      <button pButton type="submit" [disabled]="policyForm.invalid">
        Créer
      </button>
    </div>
  </form>
</p-dialog>
